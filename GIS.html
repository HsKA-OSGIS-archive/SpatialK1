<!DOCTYPE html >
<html>
    <head>
        <title>OpenLayers Map Controls</title>
		<meta charset="utf-8"/>
		<html xmlns="http://www.w3.org/1999/xhtml">
		<script src="http://cdnjs.cloudflare.com/ajax/libs/openlayers/2.13.1/OpenLayers.js"></script>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/openlayers/2.13.1/theme/default/style.css" type="text/css">
        <style>body, html, #map { width: 99%; height: 99%; }</style>
		<!--<link rel="stylesheet" href="./style.css" type="text/css">-->
		
		<script src="map.js" charset="UTF-8"></script>
		<script src="http://code.jquery.com/jquery-latest.min.js" type="text/javascript"></script>
        <script src="geoJson.js" type="text/javascript" charset="utf-8"></script>
        <link href="GUI/style.css" rel="stylesheet" type="text/css" />
		<link href="map_style.css" rel="stylesheet" type="text/css" />
		<script src="GUI/interfaceFunctionaity.js" type="text/javascript"></script>



    </head>
    <body>
        <div id="map"></div>


         <div id="search">
            <input type="text" name="addr" value="" id="addr" size="10" onkeydown = "if (event.keyCode == 13)
            			document.getElementById('btnSearch').click()" />
            <button type="button" id= "btnSearch" onclick="addr_search();">Search</button>
            <div id="results"></div>
        </div>
		
		
		<div id="Container">
			<h1>DOSISRECHNER</h1>
		  <form name="persData">
				 <h2>Persönliche Informationen</h2>
				 <div class="InputUnit"><!-- general personal data-->
					<div class="vNameValueContainer"><!-- Alter -->
						<label class="elemName">Alter</label>
						<select class="elemValue" name="age" id="age_dropdown" onchange="ageGroup = this;">
							<option value="A1">&lt; 1 a</option>
							<option value="A2">1 - 2 a</option>
							<option value="A3">2 - 7 a</option>
							<option value="A4">7 - 12 a</option>
							<option value="A5">12 - 17 a</option>
							<option value="A6">&gt 17 a</option>
						</select>
					</div><!-- END Alter -->
				   <div class="hNameValueContainer"><!-- pregnancy -->
						<label class="elemName">Schwangerschaft</label>
						<input class="elemValue" type="checkbox" name="pregnancy" id="pregnancy_dropdown" onchange="if(this.checked == false){statiumFoetus = 0} else{staiumFoetus = 1}"/>	
					</div><!-- END pregnancy -->
				</div><!-- END general personal data-->
				<h2>Aufenthalte</h2>
				<div class="InputUnit"><!-- Departure info input -->
					<div class="hNameValueContainer"><!-- Input elements for departure location -->
						<label class="elemName">Start</label>
						<input type="datetime" class="elemValue" name="start"/>
					</div><!-- END Input elements for departure location -->
					<!--div class="hNameValueContainer">
						<label class="elemName">Aufenthaltsdauer</label>
						<input type="text" class="elemValue" name="startDuration"/>
					</div><-- END Duration of residence -->
					<div class="hNameValueContainer">
					<!-- Input elements for departing info -->
						<label class="elemName">Ziel</label>
						<input type="datetime" class="elemValue" name="destination"/>
					</div>
					</div>
					<!--div class="hNameValueContainer">
						<label class="elemName">Aufenthaltsdauer</label>
						<input type="text" class="elemValue" name="destinationDuration"/>
					</div-->
					<div class="InputUnit">
					<h2>Schutzmaßnahmen</h2>
					<div class="rollOutMenu"><!--Protection mesures-->
						<div class="hNameValueContainer">
							<label class="elemName">Gasmaske</label>
							<input class="elemValue" type="checkbox" name="Gasmask" onchange="if(this.checked == false){
									while(actions.indexOf('protecting_mask') != -1){
										actions.splice(actions.indexOf('protecting_mask'), 1);
									}
								}
								else{
									actions.push('protecting_mask');
								}
								alert(actions);"/>
						</div>
						<div class="hNameValueContainer">
							<label class="elemName">Iodtablette</label>
							<input class="elemValue" type="checkbox" name="Iodine" onchange="if(this.checked == false){
									while(actions.indexOf('iodine') != -1){
										actions.splice(actions.indexOf('iodine'), 1);
									}
								}
								else{
									actions.push('iodine');
								}
								alert(actions);"/>
						</div>
						<div class="hNameValueContainer">
							<label class="elemName">Evakuierung</label>
							<input class="elemValue" type="checkbox" name="Evacuation" onchange="if(this.checked == false){
									while(actions.indexOf('evacuation') != -1){
										actions.splice(actions.indexOf('evacuation'), 1);
									}
								}
								else{
									actions.push('evacuation');
								}
								alert(actions);"/>
						</div>
					</div><!--END protection mesures-->
					<div class="vNameValueContainer"><!-- residens start-->
						<label class="elemName">Aufenthaltsort</label>
						<select class="elemValue" name="residenceStart" onchange="residence = this.value;">
							<option value="outside">im Freien / Auto</option>
							<option value="house">Haus</option>
							<option value="basement">Keller</option>
						</select>
					</div><!-- END residens start-->
				</div><!-- END Input elements for departure info-->
				<div class="button" onclick="JSONXML()">Dosis Berechnen</div>
				</form>
			 </div>
		</div>

		<script type="text/javascript" href="geoJson.js"></script>
		<script  src="XML_Writer.js"></script>
		<script  src="XML_script.js"></script>
        <script type="text/javascript">
        // init the map object with a OSM base layer.

       	var ageGroup;
		var stadiumFoetus;
		var json_var;
		 
		 
		function readDropdown(){
			ageGroup = document.getElementById("age_dropdown").value;
			stadiumFoetus = document.getElementById("pregnancy_dropdown").value;
		}
		
		function JSONXML(){
		
			inJson();
			createXML();
		
		}




	   var map = new OpenLayers.Map('map', {
                layers: [
                    new OpenLayers.Layer.OSM('OSM'),
                    new OpenLayers.Layer.OSM('OpenCycleMap',
                    ['http://a.tile.opencyclemap.org/cycle/${z}/${x}/${y}.png',
                    'http://b.tile.opencyclemap.org/cycle/${z}/${x}/${y}.png',
                    'http://c.tile.opencyclemap.org/cycle/${z}/${x}/${y}.png'])
                    ],
                controls: [
                    new OpenLayers.Control.Navigation(),
                    new OpenLayers.Control.Attribution(),
                   //new OpenLayers.Control.PanZoomBar(),
                    new OpenLayers.Control.LayerSwitcher({
                        'ascending': true
                    }),
                    new OpenLayers.Control.ScaleLine(),
                    new OpenLayers.Control.MousePosition(),
                    new OpenLayers.Control.SelectFeature(),
                    new OpenLayers.Control.KeyboardDefaults(),
                    
                ],
                center: new OpenLayers.LonLat(8.4028, 49.011 ).transform('EPSG:4326', 'EPSG:3857'),
                zoom: 13
           
            });
    
		var styleMap = new OpenLayers.StyleMap({
				
				"default": 	new OpenLayers.Style({
				 strokeWidth: 4,
				 strokeColor: '#1c74cc',
				 strokeOpacity:1,
            }),
               "select": new OpenLayers.Style({
                strokeWidth: 5,
			    strokeColor: '#d81b23',
				strokeOpacity: 1,
            })
		});
		var editingLayer = new OpenLayers.Layer.Vector("Editing", {styleMap: styleMap} );
		 var drawControls ={
			line: new OpenLayers.Control.DrawFeature(editingLayer,
						OpenLayers.Handler.Path),
			drag: new OpenLayers.Control.DragFeature(editingLayer),
			select: new OpenLayers.Control.SelectFeature(
					editingLayer,
					{
						clickout: true, toggle: false,
						multiple: false, hover: false,
						toggleKey: "ctrlKey", // ctrl key removes from selection
						multipleKey: "shiftKey", // shift key adds to selection
						box: true,
						click: true

					}


				)
			

		};		



		
				
		map.addLayers([editingLayer]);
	
        	


		for(var key in drawControls) {
					map.addControl(drawControls[key]);
		}

		//selects control
		function toggleControl(element) {
			for(key in drawControls) {
				var control = drawControls[key];
				if(element == key && element) {
					control.activate();
				} else {
					control.deactivate();
				}
			}
		}

        </script>

         <div id="search">
            <input type="text" name="addr" value="" id="addr" size="10" onkeydown = "if (event.keyCode == 13)
            			document.getElementById('btnSearch').click()" />
            <button type="button" id= "btnSearch" onclick="addr_search();">Search</button>
            <div id="results"></div>
        </div>


		<div id= "toolbar">
			<img id="line" src="./Buttons/draw.svg" width="30px" height="30px"  onclick="toggleControl(this.id);"/></img>
			
			<img id="drag" src="./Buttons/drag.svg" width="30px" height="30px"  onclick="toggleControl(this.id);"/></img>
			<img id="select" src="./Buttons/select.svg" width="30px" height="30px"   onclick="toggleControl(this.id);"/></img>
			<img id="erase" src="./Buttons/erase.svg" width="30px" height="30px"   onclick="editingLayer.removeFeatures(editingLayer.selectedFeatures)"/></img>
			
			
		</div>

    </body>
</html>